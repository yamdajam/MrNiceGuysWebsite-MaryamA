<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Choc Cupcakes - Mister Nice Guys</title>
  <link rel="icon" type="image/x-icon" href="https://www.misterniceguy.com.au/wp-content/themes/misterniceguy/images/global/logo.png">

  <!--Google fonts embed-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Barriecito&family=Nunito:ital,wght@0,200..1000;1,200..1000&family=Pacifico&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="reset.css">
  <link rel="stylesheet" href="styles.css"/>
</head>

<body>
<!--NAVBAR PLACEHOLDER -->
  <div id="navbar-placeholder"></div>

  <!--Go Back navigation-->
  <a href="javascript:history.back()" class="back-button">
  <img src="goback.svg" alt="Go Back"></a>


  <main>
    <a href="choose-base.html" class="go-back">Go back</a>
    <h1>Chocolate Cupcakes</h1>
    <div class="cupcake-grid">
      <div class="cupcake-card">
        <img src="Choc-cupcakes/rockinrollin.svg" alt="Rockin Rollin" />
        <p>Rockin Rollin</p>
        <button onclick="openModal('rockin')">View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/countchocula.svg" alt="Count Chocula" />
        <p>Count Chocula</p>
        <button onclick="openModal('count')">View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/neopolitan.svg" alt="Neapolitan" />
        <p>Neapolitan</p>
        <button>View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/smores.svg" alt="Smores" />
        <p>Smores</p>
        <button>View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/coffee&donuts.svg" alt="Coffee & Donuts" />
        <p>Coffee & Donuts</p>
        <button>View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/turkishdelight.svg" alt="Turkish Delight"/>
        <p>Turkish Delight</p>
        <button>View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/raspberrychoc.svg" alt="Raspberry Choc" />
        <p>Raspberry Choc</p>
        <button>View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/snickers.svg" alt="Snickers" />
        <p>Snickers</p>
        <button>View</button>
      </div>
    </div>

    <!-- Rockin Rollin Popup -->
     <div id="rockin" class="modal">
      <div class="modal-content">
        <div class="modal-left">
          <h2>Rockin Rollin</h2>
          <img src="Choc-cupcakes/rockinrollin.svg" alt="Rockin Rollin" />
          <p class="desc">Chocolate cupcake with Strawberry Frosting and Chocolate Ganache</p>
        </div>

        <div class="modal-right">
          <div class="option-row">
            <label>Mini</label>
            <div class="qty-control">
              <button onclick="changeQty('mini1', -1)">−</button>
              <input type="text" id="mini1" value="0" readonly />
              <button onclick="changeQty('mini1', 1)">+</button>
              <span>$</span><input type="text" class="price" id="miniPrice" value="0" readonly />
            </div>
          </div>

          <div class="option-row">
            <label>Reg</label>
            <div class="qty-control">
              <button onclick="changeQty('reg1', -1)">−</button>
              <input type="text" id="reg1" value="0" readonly />
              <button onclick="changeQty('reg1', 1)">+</button>
              <span>$</span><input type="text" class="price" id="regPrice" value="0" readonly />
            </div>
          </div>

          <div class="total-display" id="totalPrice">Total: $0.00</div>
          <button class="add-cart" onclick="addToCart()">ADD TO CART</button>
          <button class="view-cart" onclick="location.href='cart.html'">VIEW CART</button>
          <button class="shop-more" onclick="closeModal('rockin')">Shop more</button>
        </div>
      </div>
    </div>

    <!-- Count Chocula Popup -->
    <div id="count" class="modal">
      <div class="modal-content">
        <div class="modal-left">
          <h2>Count Chocula</h2>
          <img src="Choc-cupcakes/countchocula.svg" alt="Count Chocula" />
          <p class="desc">Chocolate cupcake with chocolate chips and fudge frosting</p>
        </div>

        <div class="modal-right">
          <div class="option-row">
            <label>Mini</label>
            <div class="qty-control">
              <button onclick="changeQty('mini2', -1)">−</button>
              <input type="text" id="mini2" value="0" readonly />
              <button onclick="changeQty('mini2', 1)">+</button>
              <span>$</span><input type="text" class="price" id="miniPrice2" value="0" readonly />
            </div>
          </div>

          <div class="option-row">
            <label>Reg</label>
            <div class="qty-control">
              <button onclick="changeQty('reg2', -1)">−</button>
              <input type="text" id="reg2" value="0" readonly />
              <button onclick="changeQty('reg2', 1)">+</button>
              <span>$</span><input type="text" class="price" id="regPrice2" value="0" readonly />
            </div>
          </div>

          <div class="total-display" id="totalPrice2">Total: $0.00</div>
          <button class="add-cart" onclick="addToCart()">ADD TO CART</button>
          <button class="view-cart" onclick="location.href='cart.html'">VIEW CART</button>
          <button class="shop-more" onclick="closeModal('count')">Shop more</button>
        </div>
      </div>
    </div>
  </main>

  <!--FOOTER-->
  <footer class="footer">
  <p>
    Terms & Conditions | Refund Policy | Privacy Policy | FAQs<br>
    <strong>Mister Nice Guys BakeShop</strong><br>
    151 Union Rd, Ascot Vale 3032 Australia<br>
    Website by Maryam AL-Mahdi<br>
    © MNG BAKERY PTY LTD 2025
  </p>
</footer>


<script>
  fetch('navbar.html')
    .then(response => response.text())
    .then(data => {
      document.getElementById('navbar-placeholder').innerHTML = data;
     
      setTimeout(() => {
        const cartData = JSON.parse(localStorage.getItem('cart') || '[]');
        const cartIcon = document.querySelector(".nav-icon img[alt='Cart']");

        if (cartIcon && cartData.length > 0) {
          let bubble = document.getElementById('cart-count');

          // If bubble doesn't exist, create it
          if (!bubble) {
            bubble = document.createElement("div");
            bubble.id = "cart-count";
            bubble.classList.add("cart-count");
            cartIcon.parentElement.style.position = "relative";
            cartIcon.parentElement.appendChild(bubble);
          }

          bubble.textContent = cartData.length;
          bubble.style.display = "inline-block";
        }
      }, 50);
    })

    .catch(error => console.error('Navbar load error:', error));


//------POP UP (MODAL)-----//    
  // Open modal
  function openModal(id) {
    document.getElementById(id).style.display = 'flex';
  }

  // Close modal on click outside
  window.onclick = function(e) {
    document.querySelectorAll('.modal').forEach(modal => {
      if (e.target === modal) {
        modal.style.display = 'none';
      }
    });
  };

  //clicking shop more closes modal
  function closeModal(id) {
    document.getElementById(id).style.display = 'none';
  }


  // Pricing 
  const PRICING = {
      mini: 3.5,
      reg: 5.6,
      minQty: {
        mini: 24,
        reg: 12
      }
    };

    function changeQty(inputId, delta) {
      const input = document.getElementById(inputId);
      const type = inputId.includes('mini') ? 'mini' : 'reg';
      let value = parseInt(input.value);
      if (isNaN(value)) value = 0;

      const newValue = Math.max(PRICING.minQty[type], value + delta);
      input.value = newValue;

      updateTotal();
    }

    //Pricing calculation
    function updateTotal() {
      const miniQty1 = parseInt(document.getElementById('mini1')?.value || 0);
      const regQty1 = parseInt(document.getElementById('reg1')?.value || 0);
      const miniQty2 = parseInt(document.getElementById('mini2')?.value || 0);
      const regQty2 = parseInt(document.getElementById('reg2')?.value || 0);

      const miniTotal1 = miniQty1 * PRICING.mini;
      const regTotal1 = regQty1 * PRICING.reg;
      const miniTotal2 = miniQty2 * PRICING.mini;
      const regTotal2 = regQty2 * PRICING.reg;

      const total1 = (miniTotal1 + regTotal1).toFixed(2);
      const total2 = (miniTotal2 + regTotal2).toFixed(2);

      if (document.getElementById('miniPrice')) document.getElementById('miniPrice').value = miniTotal1.toFixed(2);
      if (document.getElementById('regPrice')) document.getElementById('regPrice').value = regTotal1.toFixed(2);
      if (document.getElementById('totalPrice')) document.getElementById('totalPrice').textContent = `Total: $${total1}`;

      if (document.getElementById('miniPrice2')) document.getElementById('miniPrice2').value = miniTotal2.toFixed(2);
      if (document.getElementById('regPrice2')) document.getElementById('regPrice2').value = regTotal2.toFixed(2);
      if (document.getElementById('totalPrice2')) document.getElementById('totalPrice2').textContent = `Total: $${total2}`;
    }

     window.onload = function () {
    ['mini1', 'reg1', 'mini2', 'reg2'].forEach(id => {
      const el = document.getElementById(id);
      if (el) {
        const type = id.includes('mini') ? 'mini' : 'reg';
        el.value = PRICING.minQty[type];
      }
    });
    updateTotal();
  };

  // ✅ FIXED: Add to Cart Logic
  function addToCart() {
    const openModal = document.querySelector('.modal[style*="display: flex"]');
    if (!openModal) return;

    const productName = openModal.querySelector('h2')?.textContent.trim();
    const productImage = openModal.querySelector('img')?.getAttribute('src') || '';

    const miniInput = openModal.querySelector('input[id^="mini"]');
    const regInput = openModal.querySelector('input[id^="reg"]');
    const miniQty = parseInt(miniInput?.value || 0);
    const regQty = parseInt(regInput?.value || 0);

    if (miniQty < PRICING.minQty.mini && regQty < PRICING.minQty.reg) return;

    const cartItem = {
      name: productName,
      image: productImage,
      qtyMini: miniQty,
      qtyReg: regQty
    };

    let cart = JSON.parse(localStorage.getItem('cart') || '[]');
    cart = cart.filter(item => item.name !== cartItem.name);
    cart.push(cartItem);
    localStorage.setItem('cart', JSON.stringify(cart));

    const bubble = document.getElementById('cart-count');
    if (bubble) {
      bubble.textContent = cart.length;
      bubble.style.display = 'inline-block';
    }

    openModal.querySelector('.add-cart').style.display = 'none';
    openModal.querySelector('.view-cart').style.display = 'inline-block';
    openModal.querySelector('.shop-more').style.display = 'inline-block';
  }
  
</script>

</body>
</html>
