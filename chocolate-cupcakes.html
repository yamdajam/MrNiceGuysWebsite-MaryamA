<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Choc Cupcakes - Mister Nice Guys</title>
  <link rel="icon" type="image/x-icon" href="https://www.misterniceguy.com.au/wp-content/themes/misterniceguy/images/global/logo.png">

  <!--Google fonts embed-->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Barriecito&family=Nunito:ital,wght@0,200..1000;1,200..1000&family=Pacifico&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="reset.css">
  <link rel="stylesheet" href="styles.css"/>
</head>

<body>
<!--NAVBAR PLACEHOLDER -->
  <div id="navbar-placeholder"></div>
  <main>
    <a href="choose-base.html" class="go-back">Go back</a>
    <h1>Chocolate Cupcakes</h1>
    <div class="cupcake-grid">
      <div class="cupcake-card">
        <img src="Choc-cupcakes/rockinrollin.svg" alt="Rockin Rollin" />
        <p>Rockin Rollin</p>
        <button onclick="openModal('rockin')">View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/countchocula.svg" alt="Count Chocula" />
        <p>Count Chocula</p>
        <button>View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/neopolitan.svg" alt="Neapolitan" />
        <p>Neapolitan</p>
        <button>View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/smores.svg" alt="Smores" />
        <p>Smores</p>
        <button>View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/coffee&donuts.svg" alt="Coffee & Donuts" />
        <p>Coffee & Donuts</p>
        <button>View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/turkishdelight.svg" alt="Turkish Delight"/>
        <p>Turkish Delight</p>
        <button>View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/raspberrychoc.svg" alt="Raspberry Choc" />
        <p>Raspberry Choc</p>
        <button>View</button>
      </div>
      <div class="cupcake-card">
        <img src="Choc-cupcakes/snickers.svg" alt="Snickers" />
        <p>Snickers</p>
        <button>View</button>
      </div>
    </div>

    <!-- Rockin Rollin Popup -->
     <div id="rockin" class="modal">
      <div class="modal-content">
        <div class="modal-left">
          <h2>Rockin Rollin</h2>
          <img src="Choc-cupcakes/rockinrollin.svg" alt="Rockin Rollin" />
          <p class="desc">Chocolate cupcake with Strawberry Frosting and Chocolate Ganache</p>
        </div>

        <div class="modal-right">
          <div class="option-row">
            <label>Mini</label>
            <div class="qty-control">
              <button onclick="changeQty('mini1', -1)">−</button>
              <input type="text" id="mini1" value="0" readonly />
              <button onclick="changeQty('mini1', 1)">+</button>
              <span>$</span><input type="text" class="price" id="miniPrice" value="0" readonly />
            </div>
          </div>

          <div class="option-row">
            <label>Reg</label>
            <div class="qty-control">
              <button onclick="changeQty('reg1', -1)">−</button>
              <input type="text" id="reg1" value="0" readonly />
              <button onclick="changeQty('reg1', 1)">+</button>
              <span>$</span><input type="text" class="price" id="regPrice" value="0" readonly />
            </div>
          </div>

          <div class="total-display" id="totalPrice">Total: $0.00</div>
          <button class="add-cart" onclick="addToCart()">ADD TO CART</button>
          <button class="view-cart" onclick="location.href='cart.html'">VIEW CART</button>
          <button class="shop-more" onclick="closeModal('rockin')">Shop more</button>
        </div>
      </div>
    </div>
  </main>

  <!--FOOTER-->
  <footer class="footer">
  <p>
    Terms & Conditions | Refund Policy | Privacy Policy | FAQs<br>
    <strong>Mister Nice Guys BakeShop</strong><br>
    151 Union Rd, Ascot Vale 3032 Australia<br>
    Website by Maryam AL-Mahdi<br>
    © MNG BAKERY PTY LTD 2025
  </p>
</footer>


<script>
  fetch('navbar.html')
    .then(response => response.text())
    .then(data => {
      document.getElementById('navbar-placeholder').innerHTML = data;
     
      setTimeout(() => {
        const cartData = JSON.parse(localStorage.getItem('cart') || '[]');
        const cartIcon = document.querySelector(".nav-icon img[alt='Cart']");

        if (cartIcon && cartData.length > 0) {
          let bubble = document.getElementById('cart-count');

          // If bubble doesn't exist, create it
          if (!bubble) {
            bubble = document.createElement("div");
            bubble.id = "cart-count";
            bubble.classList.add("cart-count");
            cartIcon.parentElement.style.position = "relative";
            cartIcon.parentElement.appendChild(bubble);
          }

          bubble.textContent = cartData.length;
          bubble.style.display = "inline-block"; // just in case
        }
      }, 50);
    })

    .catch(error => console.error('Navbar load error:', error));


//------POP UP (MODAL)-----//    
  // Open modal
  function openModal(id) {
    document.getElementById(id).style.display = 'flex';
  }

  // Close modal on click outside
  window.onclick = function(e) {
    document.querySelectorAll('.modal').forEach(modal => {
      if (e.target === modal) {
        modal.style.display = 'none';
      }
    });
  };

  //clicking shop more closes modal
  function closeModal(id) {
  document.getElementById(id).style.display = 'none';
}


  // Pricing 
  const PRICING = {
      mini: 3.5,
      reg: 5.6,
      minQty: {
        mini: 24,
        reg: 12
      }
    };

    function changeQty(inputId, delta) {
      const input = document.getElementById(inputId);
      const type = inputId.includes('mini') ? 'mini' : 'reg';
      let value = parseInt(input.value);
      if (isNaN(value)) value = 0;

      const newValue = Math.max(PRICING.minQty[type], value + delta);
      input.value = newValue;

      updateTotal();
    }

    //Pricing calculation
    function updateTotal() {
      const miniQty = parseInt(document.getElementById('mini1').value) || 0;
      const regQty = parseInt(document.getElementById('reg1').value) || 0;

      const miniTotal = miniQty * PRICING.mini;
      const regTotal = regQty * PRICING.reg;
      const grandTotal = (miniTotal + regTotal).toFixed(2);

      document.getElementById('miniPrice').value = miniTotal.toFixed(2);
      document.getElementById('regPrice').value = regTotal.toFixed(2);
      document.getElementById('totalPrice').textContent = `Total: $${grandTotal}`;
    }

    window.onload = function () {
      document.getElementById('mini1').value = 0;
      document.getElementById('reg1').value = 0;
      updateTotal();
    };
  

  //adding to cart
  function addToCart() {
    const miniQty = parseInt(document.getElementById('mini1').value) || 0;
    const regQty = parseInt(document.getElementById('reg1').value) || 0;

  const cartItem = {
    name: "Rockin Rollin",
    image: "Choc-cupcakes/rockinrollin.svg",
    qtyMini: miniQty,
    qtyReg: regQty
  };

  // Get existing cart or initialize empty array
  let cart = JSON.parse(localStorage.getItem('cart') || '[]');

  // Optional: Remove duplicates (replace same item)
  cart = cart.filter(item => item.name !== cartItem.name);

  // Add new item
  cart.push(cartItem);

  // Save to localStorage
  localStorage.setItem('cart', JSON.stringify(cart));

  // Show cart view/shop more buttons
  document.querySelector('.add-cart').style.display = 'none';
  document.querySelector('.view-cart').style.display = 'inline-block';
  document.querySelector('.shop-more').style.display = 'inline-block';

  // Update cart icon bubble
  const bubble = document.getElementById('cart-count');
  if (bubble) bubble.style.display = 'inline-block';
}

</script>

</body>
</html>
